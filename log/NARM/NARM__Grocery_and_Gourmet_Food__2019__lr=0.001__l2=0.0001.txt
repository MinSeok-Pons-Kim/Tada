INFO:root:Namespace(model_name='NARM')
INFO:root:--------------------------------------------- BEGIN: 2020-11-03 11:18:10 ---------------------------------------------
INFO:root:
========================================
 Arguments       | Values               
========================================
 attention_size  | 16                  
 batch_size      | 256                 
 buffer          | 1                   
 dataset         | Grocery_and_Gourm...
 dropout         | 0.2                 
 early_stop      | 5                   
 emb_size        | 64                  
 epoch           | 100                 
 eval_batch_size | 256                 
 gpu             | 0                   
 hidden_size     | 100                 
 history_max     | 20                  
 l2              | 0.0001              
 load            | 0                   
 lr              | 0.001               
 metric          | ["NDCG","HR"]       
 num_neg         | 1                   
 num_workers     | 5                   
 optimizer       | Adam                
 random_seed     | 2019                
 topk            | [5,10]              
========================================
INFO:root:# cuda devices: 1
INFO:root:Load corpus from ../data/Grocery_and_Gourmet_Food/BaseReader.pkl
INFO:root:#params: 656864
INFO:root:NARM(
  (i_embeddings): Embedding(8457, 64)
  (encoder_g): GRU(64, 100, batch_first=True)
  (encoder_l): GRU(64, 100, batch_first=True)
  (A1): Linear(in_features=100, out_features=16, bias=False)
  (A2): Linear(in_features=100, out_features=16, bias=False)
  (attention_out): Linear(in_features=16, out_features=1, bias=False)
  (out): Linear(in_features=200, out_features=64, bias=False)
)
INFO:root:Test Before Training: (HR@10:0.0901,HR@5:0.0425,NDCG@10:0.0399,NDCG@5:0.0248)
INFO:root:Optimizer: Adam
INFO:root:Epoch 1     loss=0.4917 [14.1 s]	 dev=(HR@5:0.2620,NDCG@5:0.1704) test=(HR@5:0.2241,NDCG@5:0.1417) [1.5 s] 
INFO:root:Save model to ../model/NARM/NARM__Grocery_and_Gourmet_Food__2019...
INFO:root:Epoch 2     loss=0.4230 [14.4 s]	 dev=(HR@5:0.3237,NDCG@5:0.2146) test=(HR@5:0.2781,NDCG@5:0.1794) [1.6 s] 
INFO:root:Save model to ../model/NARM/NARM__Grocery_and_Gourmet_Food__2019...
INFO:root:Epoch 3     loss=0.3957 [15.4 s]	 dev=(HR@5:0.3359,NDCG@5:0.2237) test=(HR@5:0.2914,NDCG@5:0.1899) [1.7 s] 
INFO:root:Save model to ../model/NARM/NARM__Grocery_and_Gourmet_Food__2019...
INFO:root:Epoch 4     loss=0.3829 [16.1 s]	 dev=(HR@5:0.3426,NDCG@5:0.2292) test=(HR@5:0.2985,NDCG@5:0.1934) [1.7 s] 
INFO:root:Save model to ../model/NARM/NARM__Grocery_and_Gourmet_Food__2019...
INFO:root:Epoch 5     loss=0.3721 [16.5 s]	 dev=(HR@5:0.3497,NDCG@5:0.2350) test=(HR@5:0.3065,NDCG@5:0.2012) [1.7 s] 
INFO:root:Save model to ../model/NARM/NARM__Grocery_and_Gourmet_Food__2019...
INFO:root:Epoch 6     loss=0.3626 [16.8 s]	 dev=(HR@5:0.3514,NDCG@5:0.2370) test=(HR@5:0.3050,NDCG@5:0.1999) [1.8 s] 
INFO:root:Save model to ../model/NARM/NARM__Grocery_and_Gourmet_Food__2019...
INFO:root:Epoch 7     loss=0.3491 [16.5 s]	 dev=(HR@5:0.3674,NDCG@5:0.2499) test=(HR@5:0.3232,NDCG@5:0.2135) [1.7 s] 
INFO:root:Save model to ../model/NARM/NARM__Grocery_and_Gourmet_Food__2019...
INFO:root:Epoch 8     loss=0.3394 [16.7 s]	 dev=(HR@5:0.3697,NDCG@5:0.2557) test=(HR@5:0.3235,NDCG@5:0.2188) [1.7 s] 
INFO:root:Save model to ../model/NARM/NARM__Grocery_and_Gourmet_Food__2019...
INFO:root:Epoch 9     loss=0.3269 [16.6 s]	 dev=(HR@5:0.3744,NDCG@5:0.2592) test=(HR@5:0.3334,NDCG@5:0.2234) [1.7 s] 
INFO:root:Save model to ../model/NARM/NARM__Grocery_and_Gourmet_Food__2019...
INFO:root:Epoch 10    loss=0.3162 [16.5 s]	 dev=(HR@5:0.3775,NDCG@5:0.2599) test=(HR@5:0.3276,NDCG@5:0.2182) [1.8 s] 
INFO:root:Save model to ../model/NARM/NARM__Grocery_and_Gourmet_Food__2019...
INFO:root:Epoch 11    loss=0.3080 [16.9 s]	 dev=(HR@5:0.3821,NDCG@5:0.2654) test=(HR@5:0.3290,NDCG@5:0.2218) [1.8 s] 
INFO:root:Save model to ../model/NARM/NARM__Grocery_and_Gourmet_Food__2019...
INFO:root:Epoch 12    loss=0.3006 [16.4 s]	 dev=(HR@5:0.3824,NDCG@5:0.2640) test=(HR@5:0.3259,NDCG@5:0.2183) [1.8 s] 
INFO:root:Epoch 13    loss=0.2924 [16.5 s]	 dev=(HR@5:0.3823,NDCG@5:0.2646) test=(HR@5:0.3326,NDCG@5:0.2232) [1.8 s] 
INFO:root:Epoch 14    loss=0.2839 [16.9 s]	 dev=(HR@5:0.3909,NDCG@5:0.2752) test=(HR@5:0.3438,NDCG@5:0.2328) [1.7 s] 
INFO:root:Save model to ../model/NARM/NARM__Grocery_and_Gourmet_Food__2019...
INFO:root:Epoch 15    loss=0.2772 [16.8 s]	 dev=(HR@5:0.3958,NDCG@5:0.2771) test=(HR@5:0.3451,NDCG@5:0.2360) [1.7 s] 
INFO:root:Save model to ../model/NARM/NARM__Grocery_and_Gourmet_Food__2019...
INFO:root:Epoch 16    loss=0.2705 [16.3 s]	 dev=(HR@5:0.3925,NDCG@5:0.2783) test=(HR@5:0.3483,NDCG@5:0.2382) [1.8 s] 
INFO:root:Save model to ../model/NARM/NARM__Grocery_and_Gourmet_Food__2019...
INFO:root:Epoch 17    loss=0.2633 [17.0 s]	 dev=(HR@5:0.3955,NDCG@5:0.2789) test=(HR@5:0.3481,NDCG@5:0.2371) [1.7 s] 
INFO:root:Save model to ../model/NARM/NARM__Grocery_and_Gourmet_Food__2019...
INFO:root:Epoch 18    loss=0.2576 [16.9 s]	 dev=(HR@5:0.3996,NDCG@5:0.2844) test=(HR@5:0.3527,NDCG@5:0.2417) [1.9 s] 
INFO:root:Save model to ../model/NARM/NARM__Grocery_and_Gourmet_Food__2019...
INFO:root:Epoch 19    loss=0.2536 [18.3 s]	 dev=(HR@5:0.3925,NDCG@5:0.2800) test=(HR@5:0.3476,NDCG@5:0.2388) [1.9 s] 
INFO:root:Epoch 20    loss=0.2458 [18.2 s]	 dev=(HR@5:0.3995,NDCG@5:0.2856) test=(HR@5:0.3550,NDCG@5:0.2469) [1.9 s] 
INFO:root:Save model to ../model/NARM/NARM__Grocery_and_Gourmet_Food__2019...
INFO:root:Epoch 21    loss=0.2405 [18.6 s]	 dev=(HR@5:0.3920,NDCG@5:0.2805) test=(HR@5:0.3460,NDCG@5:0.2396) [1.9 s] 
INFO:root:Epoch 22    loss=0.2382 [18.6 s]	 dev=(HR@5:0.3918,NDCG@5:0.2824) test=(HR@5:0.3491,NDCG@5:0.2437) [2.0 s] 
INFO:root:Epoch 23    loss=0.2319 [16.6 s]	 dev=(HR@5:0.3961,NDCG@5:0.2837) test=(HR@5:0.3515,NDCG@5:0.2426) [1.8 s] 
INFO:root:Epoch 24    loss=0.2278 [17.7 s]	 dev=(HR@5:0.3978,NDCG@5:0.2863) test=(HR@5:0.3540,NDCG@5:0.2469) [1.8 s] 
INFO:root:Save model to ../model/NARM/NARM__Grocery_and_Gourmet_Food__2019...
INFO:root:Epoch 25    loss=0.2224 [16.4 s]	 dev=(HR@5:0.4074,NDCG@5:0.2901) test=(HR@5:0.3557,NDCG@5:0.2491) [1.7 s] 
INFO:root:Save model to ../model/NARM/NARM__Grocery_and_Gourmet_Food__2019...
INFO:root:Epoch 26    loss=0.2206 [15.8 s]	 dev=(HR@5:0.3976,NDCG@5:0.2859) test=(HR@5:0.3512,NDCG@5:0.2440) [1.5 s] 
INFO:root:Epoch 27    loss=0.2162 [14.7 s]	 dev=(HR@5:0.3993,NDCG@5:0.2900) test=(HR@5:0.3502,NDCG@5:0.2465) [1.5 s] 
INFO:root:Epoch 28    loss=0.2110 [15.0 s]	 dev=(HR@5:0.4023,NDCG@5:0.2919) test=(HR@5:0.3577,NDCG@5:0.2539) [1.6 s] 
INFO:root:Save model to ../model/NARM/NARM__Grocery_and_Gourmet_Food__2019...
INFO:root:Epoch 29    loss=0.2095 [15.0 s]	 dev=(HR@5:0.3980,NDCG@5:0.2896) test=(HR@5:0.3551,NDCG@5:0.2509) [1.6 s] 
INFO:root:Epoch 30    loss=0.2028 [15.0 s]	 dev=(HR@5:0.4044,NDCG@5:0.2933) test=(HR@5:0.3576,NDCG@5:0.2511) [1.7 s] 
INFO:root:Save model to ../model/NARM/NARM__Grocery_and_Gourmet_Food__2019...
INFO:root:Epoch 31    loss=0.2020 [14.8 s]	 dev=(HR@5:0.4006,NDCG@5:0.2897) test=(HR@5:0.3519,NDCG@5:0.2461) [1.6 s] 
INFO:root:Epoch 32    loss=0.1990 [15.0 s]	 dev=(HR@5:0.4003,NDCG@5:0.2935) test=(HR@5:0.3528,NDCG@5:0.2508) [1.6 s] 
INFO:root:Save model to ../model/NARM/NARM__Grocery_and_Gourmet_Food__2019...
INFO:root:Epoch 33    loss=0.1974 [15.1 s]	 dev=(HR@5:0.4053,NDCG@5:0.2982) test=(HR@5:0.3665,NDCG@5:0.2609) [1.6 s] 
INFO:root:Save model to ../model/NARM/NARM__Grocery_and_Gourmet_Food__2019...
INFO:root:Epoch 34    loss=0.1948 [15.1 s]	 dev=(HR@5:0.3998,NDCG@5:0.2937) test=(HR@5:0.3518,NDCG@5:0.2505) [1.6 s] 
INFO:root:Epoch 35    loss=0.1926 [14.3 s]	 dev=(HR@5:0.4068,NDCG@5:0.2988) test=(HR@5:0.3581,NDCG@5:0.2559) [1.5 s] 
INFO:root:Save model to ../model/NARM/NARM__Grocery_and_Gourmet_Food__2019...
INFO:root:Epoch 36    loss=0.1878 [15.5 s]	 dev=(HR@5:0.4049,NDCG@5:0.2967) test=(HR@5:0.3538,NDCG@5:0.2517) [1.6 s] 
INFO:root:Epoch 37    loss=0.1835 [15.0 s]	 dev=(HR@5:0.4013,NDCG@5:0.2963) test=(HR@5:0.3570,NDCG@5:0.2546) [1.7 s] 
INFO:root:Epoch 38    loss=0.1807 [15.0 s]	 dev=(HR@5:0.4077,NDCG@5:0.3003) test=(HR@5:0.3577,NDCG@5:0.2556) [1.6 s] 
INFO:root:Save model to ../model/NARM/NARM__Grocery_and_Gourmet_Food__2019...
INFO:root:Epoch 39    loss=0.1777 [13.9 s]	 dev=(HR@5:0.4056,NDCG@5:0.2971) test=(HR@5:0.3583,NDCG@5:0.2574) [1.5 s] 
INFO:root:Epoch 40    loss=0.1782 [13.7 s]	 dev=(HR@5:0.4046,NDCG@5:0.2967) test=(HR@5:0.3623,NDCG@5:0.2583) [1.5 s] 
INFO:root:Epoch 41    loss=0.1766 [13.6 s]	 dev=(HR@5:0.4072,NDCG@5:0.2985) test=(HR@5:0.3589,NDCG@5:0.2576) [1.5 s] 
INFO:root:Epoch 42    loss=0.1767 [13.5 s]	 dev=(HR@5:0.4051,NDCG@5:0.2951) test=(HR@5:0.3536,NDCG@5:0.2508) [1.3 s] 
INFO:root:Epoch 43    loss=0.1716 [10.5 s]	 dev=(HR@5:0.4101,NDCG@5:0.3017) test=(HR@5:0.3609,NDCG@5:0.2586) [1.1 s] 
INFO:root:Save model to ../model/NARM/NARM__Grocery_and_Gourmet_Food__2019...
INFO:root:Epoch 44    loss=0.1722 [9.7 s]	 dev=(HR@5:0.4067,NDCG@5:0.2967) test=(HR@5:0.3510,NDCG@5:0.2499) [1.1 s] 
INFO:root:Epoch 45    loss=0.1685 [9.9 s]	 dev=(HR@5:0.4077,NDCG@5:0.2992) test=(HR@5:0.3559,NDCG@5:0.2547) [1.1 s] 
INFO:root:Epoch 46    loss=0.1653 [9.1 s]	 dev=(HR@5:0.4042,NDCG@5:0.2992) test=(HR@5:0.3534,NDCG@5:0.2534) [1.1 s] 
INFO:root:Epoch 47    loss=0.1650 [9.6 s]	 dev=(HR@5:0.4143,NDCG@5:0.3051) test=(HR@5:0.3587,NDCG@5:0.2584) [1.0 s] 
INFO:root:Save model to ../model/NARM/NARM__Grocery_and_Gourmet_Food__2019...
INFO:root:Epoch 48    loss=0.1637 [9.5 s]	 dev=(HR@5:0.4090,NDCG@5:0.3003) test=(HR@5:0.3548,NDCG@5:0.2536) [1.1 s] 
INFO:root:Epoch 49    loss=0.1587 [9.6 s]	 dev=(HR@5:0.4064,NDCG@5:0.3013) test=(HR@5:0.3578,NDCG@5:0.2569) [1.1 s] 
INFO:root:Epoch 50    loss=0.1621 [9.3 s]	 dev=(HR@5:0.4039,NDCG@5:0.2994) test=(HR@5:0.3551,NDCG@5:0.2545) [1.0 s] 
INFO:root:Epoch 51    loss=0.1575 [9.6 s]	 dev=(HR@5:0.3997,NDCG@5:0.2945) test=(HR@5:0.3547,NDCG@5:0.2505) [1.1 s] 
INFO:root:Epoch 52    loss=0.1572 [9.8 s]	 dev=(HR@5:0.4105,NDCG@5:0.3024) test=(HR@5:0.3626,NDCG@5:0.2613) [1.1 s] 
INFO:root:Epoch 53    loss=0.1569 [9.6 s]	 dev=(HR@5:0.4094,NDCG@5:0.3012) test=(HR@5:0.3601,NDCG@5:0.2593) [1.0 s] 
INFO:root:Epoch 54    loss=0.1559 [9.7 s]	 dev=(HR@5:0.4046,NDCG@5:0.2962) test=(HR@5:0.3607,NDCG@5:0.2588) [1.1 s] 
INFO:root:Epoch 55    loss=0.1562 [9.6 s]	 dev=(HR@5:0.4062,NDCG@5:0.2973) test=(HR@5:0.3562,NDCG@5:0.2529) [1.1 s] 
INFO:root:Epoch 56    loss=0.1532 [10.0 s]	 dev=(HR@5:0.4068,NDCG@5:0.2962) test=(HR@5:0.3555,NDCG@5:0.2537) [1.0 s] 
INFO:root:Epoch 57    loss=0.1513 [8.4 s]	 dev=(HR@5:0.4044,NDCG@5:0.2951) test=(HR@5:0.3540,NDCG@5:0.2507) [1.4 s] 
INFO:root:Epoch 58    loss=0.1491 [8.8 s]	 dev=(HR@5:0.4040,NDCG@5:0.2979) test=(HR@5:0.3562,NDCG@5:0.2539) [0.9 s] 
INFO:root:Epoch 59    loss=0.1484 [8.2 s]	 dev=(HR@5:0.4014,NDCG@5:0.2961) test=(HR@5:0.3523,NDCG@5:0.2510) [1.0 s] 
INFO:root:Epoch 60    loss=0.1491 [8.1 s]	 dev=(HR@5:0.4090,NDCG@5:0.2969) test=(HR@5:0.3501,NDCG@5:0.2491) [0.9 s] 
INFO:root:Epoch 61    loss=0.1481 [8.2 s]	 dev=(HR@5:0.4079,NDCG@5:0.2989) test=(HR@5:0.3548,NDCG@5:0.2547) [1.0 s] 
INFO:root:Epoch 62    loss=0.1439 [8.3 s]	 dev=(HR@5:0.4045,NDCG@5:0.2971) test=(HR@5:0.3525,NDCG@5:0.2527) [0.9 s] 
INFO:root:Epoch 63    loss=0.1460 [8.4 s]	 dev=(HR@5:0.4023,NDCG@5:0.2961) test=(HR@5:0.3543,NDCG@5:0.2531) [1.0 s] 
INFO:root:Epoch 64    loss=0.1450 [7.8 s]	 dev=(HR@5:0.4074,NDCG@5:0.3019) test=(HR@5:0.3581,NDCG@5:0.2581) [1.0 s] 
INFO:root:Epoch 65    loss=0.1438 [8.5 s]	 dev=(HR@5:0.4085,NDCG@5:0.3004) test=(HR@5:0.3532,NDCG@5:0.2539) [0.9 s] 
INFO:root:Epoch 66    loss=0.1437 [8.2 s]	 dev=(HR@5:0.4051,NDCG@5:0.2987) test=(HR@5:0.3528,NDCG@5:0.2516) [1.0 s] 
INFO:root:Epoch 67    loss=0.1437 [8.0 s]	 dev=(HR@5:0.4098,NDCG@5:0.3021) test=(HR@5:0.3545,NDCG@5:0.2544) [0.9 s] 
INFO:root:Early stop at 67 based on dev result.
INFO:root:
Best Iter(dev)=   47	 dev=(HR@5:0.4143,NDCG@5:0.3051) test=(HR@5:0.3587,NDCG@5:0.2584) [990.9 s] 
INFO:root:Load model from ../model/NARM/NARM__Grocery_and_Gourmet_Food__2019__lr=0.001__l2=0.0001.pt
INFO:root:
Test After Training: (HR@10:0.4687,HR@5:0.3587,NDCG@10:0.2939,NDCG@5:0.2584)
INFO:root:
--------------------------------------------- END: 2020-11-03 11:34:49 ---------------------------------------------
