INFO:root:Namespace(model_name='SASRec')
INFO:root:--------------------------------------------- BEGIN: 2020-11-16 17:05:51 ---------------------------------------------
INFO:root:
========================================
 Arguments       | Values               
========================================
 batch_size      | 256                 
 buffer          | 1                   
 dataset         | Grocery_and_Gourm...
 dropout         | 0                   
 early_stop      | 5                   
 emb_size        | 64                  
 epoch           | 100                 
 eval_batch_size | 256                 
 finetune        | 0                   
 gpu             | 0                   
 hidden_size     | 100                 
 history_max     | 20                  
 l2              | 1e-06               
 load            | 0                   
 lr              | 0.0001              
 metric          | ["NDCG","HR"]       
 num_heads       | 1                   
 num_layers      | 1                   
 num_neg         | 1                   
 num_workers     | 5                   
 optimizer       | Adam                
 random_seed     | 2019                
 result_file     | ../result/SASRec/...
 suffix          | tada                
 test_length     | 5                   
 topk            | [5,10]              
========================================
INFO:root:cuda available: True
INFO:root:# cuda devices: 1
INFO:root:Load corpus from ../data/Grocery_and_Gourmet_Food/tada/5/BaseReader.pkl
INFO:root:#params: 563648
INFO:root:SASRec(
  (i_embeddings): Embedding(8457, 64)
  (p_embeddings): Embedding(21, 64)
  (transformer_block): ModuleList(
    (0): TransformerLayer(
      (masked_attn_head): MultiHeadAttention(
        (v_linear): Linear(in_features=64, out_features=64, bias=True)
        (k_linear): Linear(in_features=64, out_features=64, bias=True)
        (q_linear): Linear(in_features=64, out_features=64, bias=True)
      )
      (layer_norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0, inplace=False)
      (linear1): Linear(in_features=64, out_features=64, bias=True)
      (linear2): Linear(in_features=64, out_features=64, bias=True)
      (layer_norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout2): Dropout(p=0, inplace=False)
    )
  )
)
INFO:root:Test Before Training: (HR@10:0.0977,HR@5:0.0497,NDCG@10:0.0445,NDCG@5:0.0292)
INFO:root:Optimizer: Adam
INFO:root:Epoch 1     loss=0.6358 [3.9 s]	 test0=(HR@5:0.2882,NDCG@5:0.1975) test4=(HR@5:0.1721,NDCG@5:0.1069) [2.4 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 2     loss=0.5251 [4.8 s]	 test0=(HR@5:0.3019,NDCG@5:0.2041) test4=(HR@5:0.1796,NDCG@5:0.1097) [2.6 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 3     loss=0.4592 [4.8 s]	 test0=(HR@5:0.3043,NDCG@5:0.2056) test4=(HR@5:0.1810,NDCG@5:0.1104) [2.3 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 4     loss=0.4219 [4.4 s]	 test0=(HR@5:0.3074,NDCG@5:0.2073) test4=(HR@5:0.1828,NDCG@5:0.1125) [2.4 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 5     loss=0.3949 [5.3 s]	 test0=(HR@5:0.3081,NDCG@5:0.2079) test4=(HR@5:0.1821,NDCG@5:0.1114) [2.6 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 6     loss=0.3796 [5.4 s]	 test0=(HR@5:0.3096,NDCG@5:0.2104) test4=(HR@5:0.1834,NDCG@5:0.1121) [2.5 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 7     loss=0.3612 [5.2 s]	 test0=(HR@5:0.3128,NDCG@5:0.2136) test4=(HR@5:0.1855,NDCG@5:0.1150) [2.4 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 8     loss=0.3469 [5.2 s]	 test0=(HR@5:0.3190,NDCG@5:0.2203) test4=(HR@5:0.1915,NDCG@5:0.1187) [2.5 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 9     loss=0.3318 [5.5 s]	 test0=(HR@5:0.3240,NDCG@5:0.2244) test4=(HR@5:0.1960,NDCG@5:0.1215) [2.5 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 10    loss=0.3177 [5.6 s]	 test0=(HR@5:0.3278,NDCG@5:0.2282) test4=(HR@5:0.1992,NDCG@5:0.1233) [2.5 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 11    loss=0.3063 [5.1 s]	 test0=(HR@5:0.3345,NDCG@5:0.2375) test4=(HR@5:0.2052,NDCG@5:0.1293) [2.5 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 12    loss=0.2950 [5.1 s]	 test0=(HR@5:0.3384,NDCG@5:0.2402) test4=(HR@5:0.2101,NDCG@5:0.1316) [2.4 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 13    loss=0.2844 [5.4 s]	 test0=(HR@5:0.3457,NDCG@5:0.2482) test4=(HR@5:0.2164,NDCG@5:0.1371) [2.4 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 14    loss=0.2729 [6.1 s]	 test0=(HR@5:0.3513,NDCG@5:0.2540) test4=(HR@5:0.2220,NDCG@5:0.1416) [2.6 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 15    loss=0.2645 [4.4 s]	 test0=(HR@5:0.3576,NDCG@5:0.2618) test4=(HR@5:0.2270,NDCG@5:0.1465) [2.4 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 16    loss=0.2523 [4.9 s]	 test0=(HR@5:0.3624,NDCG@5:0.2651) test4=(HR@5:0.2308,NDCG@5:0.1498) [2.4 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 17    loss=0.2444 [7.2 s]	 test0=(HR@5:0.3641,NDCG@5:0.2661) test4=(HR@5:0.2322,NDCG@5:0.1504) [3.2 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 18    loss=0.2346 [7.2 s]	 test0=(HR@5:0.3705,NDCG@5:0.2741) test4=(HR@5:0.2396,NDCG@5:0.1573) [3.1 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 19    loss=0.2259 [7.0 s]	 test0=(HR@5:0.3763,NDCG@5:0.2772) test4=(HR@5:0.2413,NDCG@5:0.1579) [2.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 20    loss=0.2174 [7.5 s]	 test0=(HR@5:0.3806,NDCG@5:0.2818) test4=(HR@5:0.2465,NDCG@5:0.1626) [3.0 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 21    loss=0.2090 [7.9 s]	 test0=(HR@5:0.3806,NDCG@5:0.2840) test4=(HR@5:0.2490,NDCG@5:0.1648) [3.0 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 22    loss=0.2023 [7.7 s]	 test0=(HR@5:0.3848,NDCG@5:0.2867) test4=(HR@5:0.2513,NDCG@5:0.1670) [3.1 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 23    loss=0.1942 [7.1 s]	 test0=(HR@5:0.3926,NDCG@5:0.2940) test4=(HR@5:0.2574,NDCG@5:0.1722) [3.0 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 24    loss=0.1844 [8.3 s]	 test0=(HR@5:0.3901,NDCG@5:0.2919) test4=(HR@5:0.2557,NDCG@5:0.1704) [2.9 s] 
INFO:root:Epoch 25    loss=0.1774 [7.7 s]	 test0=(HR@5:0.3948,NDCG@5:0.2968) test4=(HR@5:0.2605,NDCG@5:0.1755) [3.2 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 26    loss=0.1724 [7.2 s]	 test0=(HR@5:0.3979,NDCG@5:0.3005) test4=(HR@5:0.2642,NDCG@5:0.1788) [2.7 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 27    loss=0.1641 [7.6 s]	 test0=(HR@5:0.3993,NDCG@5:0.3016) test4=(HR@5:0.2663,NDCG@5:0.1806) [3.4 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 28    loss=0.1578 [6.5 s]	 test0=(HR@5:0.4016,NDCG@5:0.3046) test4=(HR@5:0.2673,NDCG@5:0.1824) [2.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 29    loss=0.1518 [7.7 s]	 test0=(HR@5:0.4031,NDCG@5:0.3089) test4=(HR@5:0.2710,NDCG@5:0.1867) [3.0 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 30    loss=0.1462 [6.5 s]	 test0=(HR@5:0.4048,NDCG@5:0.3085) test4=(HR@5:0.2684,NDCG@5:0.1852) [2.8 s] 
INFO:root:Epoch 31    loss=0.1393 [7.6 s]	 test0=(HR@5:0.4077,NDCG@5:0.3124) test4=(HR@5:0.2708,NDCG@5:0.1884) [2.7 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 32    loss=0.1337 [7.5 s]	 test0=(HR@5:0.4089,NDCG@5:0.3134) test4=(HR@5:0.2730,NDCG@5:0.1906) [3.1 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 33    loss=0.1301 [8.6 s]	 test0=(HR@5:0.4105,NDCG@5:0.3153) test4=(HR@5:0.2735,NDCG@5:0.1917) [2.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 34    loss=0.1247 [6.9 s]	 test0=(HR@5:0.4124,NDCG@5:0.3186) test4=(HR@5:0.2769,NDCG@5:0.1944) [2.7 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 35    loss=0.1195 [8.7 s]	 test0=(HR@5:0.4140,NDCG@5:0.3201) test4=(HR@5:0.2789,NDCG@5:0.1965) [2.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 36    loss=0.1150 [7.9 s]	 test0=(HR@5:0.4156,NDCG@5:0.3220) test4=(HR@5:0.2777,NDCG@5:0.1970) [3.7 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 37    loss=0.1087 [8.0 s]	 test0=(HR@5:0.4146,NDCG@5:0.3239) test4=(HR@5:0.2805,NDCG@5:0.1994) [3.2 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 38    loss=0.1049 [7.3 s]	 test0=(HR@5:0.4172,NDCG@5:0.3241) test4=(HR@5:0.2790,NDCG@5:0.1976) [2.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 39    loss=0.1009 [7.8 s]	 test0=(HR@5:0.4175,NDCG@5:0.3261) test4=(HR@5:0.2832,NDCG@5:0.2011) [3.7 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 40    loss=0.0969 [7.6 s]	 test0=(HR@5:0.4191,NDCG@5:0.3275) test4=(HR@5:0.2822,NDCG@5:0.2009) [2.9 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 41    loss=0.0931 [8.6 s]	 test0=(HR@5:0.4193,NDCG@5:0.3279) test4=(HR@5:0.2842,NDCG@5:0.2024) [2.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 42    loss=0.0902 [7.9 s]	 test0=(HR@5:0.4181,NDCG@5:0.3282) test4=(HR@5:0.2856,NDCG@5:0.2041) [2.7 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 43    loss=0.0867 [7.8 s]	 test0=(HR@5:0.4201,NDCG@5:0.3295) test4=(HR@5:0.2854,NDCG@5:0.2047) [3.3 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 44    loss=0.0832 [7.7 s]	 test0=(HR@5:0.4166,NDCG@5:0.3267) test4=(HR@5:0.2822,NDCG@5:0.2019) [3.4 s] 
INFO:root:Epoch 45    loss=0.0805 [8.0 s]	 test0=(HR@5:0.4200,NDCG@5:0.3307) test4=(HR@5:0.2893,NDCG@5:0.2078) [2.8 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
INFO:root:Epoch 46    loss=0.0770 [7.9 s]	 test0=(HR@5:0.4193,NDCG@5:0.3295) test4=(HR@5:0.2844,NDCG@5:0.2043) [2.9 s] 
INFO:root:Epoch 47    loss=0.0744 [7.4 s]	 test0=(HR@5:0.4188,NDCG@5:0.3313) test4=(HR@5:0.2891,NDCG@5:0.2087) [3.0 s] 
INFO:root:Save model to ../model/SASRec/SASRec__Grocery_and_Gourmet_Food__...
