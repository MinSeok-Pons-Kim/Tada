INFO:root:Namespace(model_name='Chorus')
INFO:root:--------------------------------------------- BEGIN: 2020-11-03 11:18:10 ---------------------------------------------
INFO:root:
========================================
 Arguments       | Values               
========================================
 base_method     | BPR                 
 batch_size      | 512                 
 buffer          | 1                   
 dataset         | Grocery_and_Gourm...
 dropout         | 0.2                 
 early_stop      | 0                   
 emb_size        | 64                  
 epoch           | 50                  
 eval_batch_size | 256                 
 gpu             | 0                   
 history_max     | 20                  
 l2              | 1e-05               
 load            | 0                   
 lr              | 0.0005              
 lr_scale        | 0.1                 
 margin          | 1.0                 
 metric          | ["NDCG","HR"]       
 num_neg         | 1                   
 num_workers     | 5                   
 optimizer       | Adam                
 random_seed     | 2019                
 stage           | 1                   
 time_scalar     | 8640000             
 topk            | [5,10]              
========================================
INFO:root:# cuda devices: 1
INFO:root:Load corpus from ../data/Grocery_and_Gourmet_Food/BaseReader.pkl
INFO:root:#params: 1504721
INFO:root:Chorus(
  (u_embeddings): Embedding(14681, 64)
  (i_embeddings): Embedding(8457, 64)
  (r_embeddings): Embedding(3, 64)
  (betas): Embedding(55, 3)
  (mus): Embedding(55, 3)
  (sigmas): Embedding(55, 3)
  (prediction): Linear(in_features=64, out_features=1, bias=False)
  (user_bias): Embedding(14681, 1)
  (item_bias): Embedding(8457, 1)
  (kg_loss): MarginRankingLoss()
)
INFO:root:Test Before Training: (HR@10:0.0985,HR@5:0.0506,NDCG@10:0.0446,NDCG@5:0.0292)
INFO:root:Optimizer: Adam
INFO:root:Epoch 1     loss=0.8548 [28.8 s]	 dev=(HR@5:0.0535,NDCG@5:0.0326) test=(HR@5:0.0508,NDCG@5:0.0303) [1.8 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 2     loss=0.7717 [29.4 s]	 dev=(HR@5:0.0533,NDCG@5:0.0320) test=(HR@5:0.0515,NDCG@5:0.0312) [2.0 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 3     loss=0.6977 [28.5 s]	 dev=(HR@5:0.0536,NDCG@5:0.0320) test=(HR@5:0.0529,NDCG@5:0.0316) [1.9 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 4     loss=0.5150 [28.4 s]	 dev=(HR@5:0.0562,NDCG@5:0.0338) test=(HR@5:0.0519,NDCG@5:0.0312) [1.9 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 5     loss=0.2700 [29.3 s]	 dev=(HR@5:0.0571,NDCG@5:0.0340) test=(HR@5:0.0531,NDCG@5:0.0318) [2.0 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 6     loss=0.1511 [29.3 s]	 dev=(HR@5:0.0566,NDCG@5:0.0340) test=(HR@5:0.0545,NDCG@5:0.0330) [2.0 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 7     loss=0.1071 [29.7 s]	 dev=(HR@5:0.0569,NDCG@5:0.0343) test=(HR@5:0.0554,NDCG@5:0.0337) [1.9 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 8     loss=0.0863 [28.8 s]	 dev=(HR@5:0.0573,NDCG@5:0.0346) test=(HR@5:0.0557,NDCG@5:0.0337) [1.9 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 9     loss=0.0742 [29.4 s]	 dev=(HR@5:0.0571,NDCG@5:0.0347) test=(HR@5:0.0561,NDCG@5:0.0339) [1.9 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 10    loss=0.0665 [29.9 s]	 dev=(HR@5:0.0577,NDCG@5:0.0348) test=(HR@5:0.0554,NDCG@5:0.0334) [2.1 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 11    loss=0.0609 [32.2 s]	 dev=(HR@5:0.0578,NDCG@5:0.0348) test=(HR@5:0.0552,NDCG@5:0.0338) [2.1 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 12    loss=0.0570 [31.9 s]	 dev=(HR@5:0.0573,NDCG@5:0.0346) test=(HR@5:0.0553,NDCG@5:0.0338) [2.0 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 13    loss=0.0540 [26.7 s]	 dev=(HR@5:0.0567,NDCG@5:0.0346) test=(HR@5:0.0557,NDCG@5:0.0338) [1.9 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 14    loss=0.0517 [28.0 s]	 dev=(HR@5:0.0565,NDCG@5:0.0344) test=(HR@5:0.0557,NDCG@5:0.0339) [1.8 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 15    loss=0.0500 [25.6 s]	 dev=(HR@5:0.0578,NDCG@5:0.0348) test=(HR@5:0.0554,NDCG@5:0.0336) [1.7 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 16    loss=0.0479 [25.8 s]	 dev=(HR@5:0.0580,NDCG@5:0.0349) test=(HR@5:0.0556,NDCG@5:0.0336) [1.7 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 17    loss=0.0464 [24.5 s]	 dev=(HR@5:0.0580,NDCG@5:0.0350) test=(HR@5:0.0556,NDCG@5:0.0338) [1.7 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 18    loss=0.0455 [26.8 s]	 dev=(HR@5:0.0577,NDCG@5:0.0349) test=(HR@5:0.0558,NDCG@5:0.0339) [1.7 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 19    loss=0.0446 [25.9 s]	 dev=(HR@5:0.0577,NDCG@5:0.0350) test=(HR@5:0.0566,NDCG@5:0.0340) [1.8 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 20    loss=0.0436 [25.6 s]	 dev=(HR@5:0.0578,NDCG@5:0.0351) test=(HR@5:0.0558,NDCG@5:0.0338) [1.8 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 21    loss=0.0430 [26.0 s]	 dev=(HR@5:0.0572,NDCG@5:0.0347) test=(HR@5:0.0552,NDCG@5:0.0334) [1.7 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 22    loss=0.0422 [23.2 s]	 dev=(HR@5:0.0584,NDCG@5:0.0352) test=(HR@5:0.0569,NDCG@5:0.0345) [1.6 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 23    loss=0.0418 [23.0 s]	 dev=(HR@5:0.0581,NDCG@5:0.0349) test=(HR@5:0.0566,NDCG@5:0.0339) [1.6 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 24    loss=0.0415 [21.2 s]	 dev=(HR@5:0.0590,NDCG@5:0.0354) test=(HR@5:0.0561,NDCG@5:0.0338) [1.4 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 25    loss=0.0409 [17.2 s]	 dev=(HR@5:0.0590,NDCG@5:0.0356) test=(HR@5:0.0567,NDCG@5:0.0343) [1.1 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 26    loss=0.0405 [16.7 s]	 dev=(HR@5:0.0595,NDCG@5:0.0355) test=(HR@5:0.0566,NDCG@5:0.0343) [1.2 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 27    loss=0.0399 [16.2 s]	 dev=(HR@5:0.0593,NDCG@5:0.0356) test=(HR@5:0.0567,NDCG@5:0.0345) [1.2 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 28    loss=0.0397 [16.3 s]	 dev=(HR@5:0.0582,NDCG@5:0.0354) test=(HR@5:0.0565,NDCG@5:0.0343) [1.2 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 29    loss=0.0394 [15.8 s]	 dev=(HR@5:0.0578,NDCG@5:0.0353) test=(HR@5:0.0557,NDCG@5:0.0337) [1.2 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 30    loss=0.0389 [16.2 s]	 dev=(HR@5:0.0589,NDCG@5:0.0358) test=(HR@5:0.0557,NDCG@5:0.0339) [1.2 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 31    loss=0.0387 [15.3 s]	 dev=(HR@5:0.0580,NDCG@5:0.0354) test=(HR@5:0.0561,NDCG@5:0.0339) [1.3 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 32    loss=0.0388 [16.4 s]	 dev=(HR@5:0.0590,NDCG@5:0.0357) test=(HR@5:0.0564,NDCG@5:0.0345) [1.2 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 33    loss=0.0382 [14.6 s]	 dev=(HR@5:0.0591,NDCG@5:0.0358) test=(HR@5:0.0557,NDCG@5:0.0341) [1.5 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 34    loss=0.0380 [14.8 s]	 dev=(HR@5:0.0580,NDCG@5:0.0354) test=(HR@5:0.0556,NDCG@5:0.0340) [1.1 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 35    loss=0.0379 [12.7 s]	 dev=(HR@5:0.0587,NDCG@5:0.0356) test=(HR@5:0.0554,NDCG@5:0.0337) [1.1 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 36    loss=0.0379 [13.6 s]	 dev=(HR@5:0.0595,NDCG@5:0.0360) test=(HR@5:0.0564,NDCG@5:0.0342) [1.1 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 37    loss=0.0377 [13.7 s]	 dev=(HR@5:0.0588,NDCG@5:0.0353) test=(HR@5:0.0565,NDCG@5:0.0345) [1.1 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 38    loss=0.0374 [13.9 s]	 dev=(HR@5:0.0595,NDCG@5:0.0357) test=(HR@5:0.0565,NDCG@5:0.0342) [1.0 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 39    loss=0.0371 [13.5 s]	 dev=(HR@5:0.0584,NDCG@5:0.0354) test=(HR@5:0.0571,NDCG@5:0.0346) [1.1 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 40    loss=0.0371 [8.0 s]	 dev=(HR@5:0.0594,NDCG@5:0.0358) test=(HR@5:0.0564,NDCG@5:0.0343) [0.8 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 41    loss=0.0371 [8.5 s]	 dev=(HR@5:0.0597,NDCG@5:0.0359) test=(HR@5:0.0570,NDCG@5:0.0346) [0.8 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 42    loss=0.0365 [7.0 s]	 dev=(HR@5:0.0597,NDCG@5:0.0359) test=(HR@5:0.0562,NDCG@5:0.0344) [0.8 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 43    loss=0.0368 [8.2 s]	 dev=(HR@5:0.0597,NDCG@5:0.0361) test=(HR@5:0.0568,NDCG@5:0.0348) [0.9 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 44    loss=0.0362 [6.0 s]	 dev=(HR@5:0.0606,NDCG@5:0.0368) test=(HR@5:0.0557,NDCG@5:0.0342) [0.9 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 45    loss=0.0359 [8.8 s]	 dev=(HR@5:0.0600,NDCG@5:0.0364) test=(HR@5:0.0564,NDCG@5:0.0344) [0.8 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 46    loss=0.0363 [7.4 s]	 dev=(HR@5:0.0591,NDCG@5:0.0360) test=(HR@5:0.0563,NDCG@5:0.0344) [0.9 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 47    loss=0.0359 [8.4 s]	 dev=(HR@5:0.0590,NDCG@5:0.0356) test=(HR@5:0.0568,NDCG@5:0.0346) [0.7 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 48    loss=0.0363 [5.9 s]	 dev=(HR@5:0.0585,NDCG@5:0.0355) test=(HR@5:0.0573,NDCG@5:0.0347) [0.9 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 49    loss=0.0360 [8.2 s]	 dev=(HR@5:0.0588,NDCG@5:0.0356) test=(HR@5:0.0575,NDCG@5:0.0350) [0.9 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:Epoch 50    loss=0.0362 [5.2 s]	 dev=(HR@5:0.0597,NDCG@5:0.0360) test=(HR@5:0.0571,NDCG@5:0.0345) [0.5 s] 
INFO:root:Save model to ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size...
INFO:root:
Best Iter(dev)=   44	 dev=(HR@5:0.0606,NDCG@5:0.0368) test=(HR@5:0.0557,NDCG@5:0.0342) [1039.0 s] 
INFO:root:Load model from ../model/KG/KG__Grocery_and_Gourmet_Food__emb_size=64__margin=1.0.pt
INFO:root:
Test After Training: (HR@10:0.1058,HR@5:0.0571,NDCG@10:0.0501,NDCG@5:0.0345)
INFO:root:
--------------------------------------------- END: 2020-11-03 11:36:16 ---------------------------------------------
